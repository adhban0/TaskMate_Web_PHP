<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TaskMate — To-do</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <style>
    body { background: #f6f7fb; }
    .card { border: 0; border-radius: 16px; }
    .shadow-soft { box-shadow: 0 10px 30px rgba(0,0,0,.06); }
    .text-muted-2 { color: #6b7280; }

    .todo-item { border: 1px solid rgba(0,0,0,.06); border-radius: 14px; }
    .todo-item + .todo-item { margin-top: 12px; }

    .pill {
      border: 1px solid rgba(0,0,0,.10);
      background: #fff;
      border-radius: 999px;
      padding: .35rem .6rem;
      font-size: .85rem;
      color: #111827;
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      white-space: nowrap;
    }

    .form-control:focus, .form-select:focus {
      box-shadow: 0 0 0 .2rem rgba(17, 24, 39, .08);
      border-color: rgba(17, 24, 39, .25);
    }

    /* Small helper so edit fields don’t look huge */
    .edit-fields { margin-top: .35rem; }
    .edit-fields .form-control { height: 34px; padding-top: .25rem; padding-bottom: .25rem; }
  </style>
</head>

<body>
  <main class="container my-4">
    <div class="d-flex flex-wrap justify-content-between align-items-end gap-2 mb-3">
      <div>
        <h2 class="mb-1">To-do list</h2>
        <div class="text-muted-2">Track tasks, due dates, and status.</div>
      </div>
      <div class="text-end">
        <div class="small text-muted-2">Today</div>
        <div class="fw-semibold" id="todayDate">—</div>
      </div>
    </div>

    <div class="row g-3">
      <div class="col-12 col-lg-4">
        <div class="card shadow-soft mb-3">
          <div class="card-body">
            <h5 class="mb-3">Add new task</h5>

            <div class="mb-2">
              <label class="form-label small text-muted-2 mb-1">Task</label>
              <input type="text" id="taskInput" class="form-control" placeholder="e.g., Finish Web2 form demo" />
            </div>

            <div class="mb-3">
              <label class="form-label small text-muted-2 mb-1">Due date (optional)</label>
              <input type="date" id="dateInput" class="form-control" />
            </div>

            <div class="d-grid">
              <button class="btn btn-dark" id="addTaskBtn">
                <i class="fa-solid fa-plus me-2"></i>Add task
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Right: Todo items -->
      <div class="col-12 col-lg-8">
        <div class="card shadow-soft">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
              <h5 class="mb-0">Your tasks</h5>
              <div class="d-flex gap-2">
                <select class="form-select">
                  <option>All</option>
                  <option>Active</option>
                  <option>Completed</option>
                </select> 
              </div>
            </div>

            <!-- Todo item -->
            <div class="todo-item p-3 bg-white">
              <div class="d-flex align-items-start justify-content-between gap-3">
                <div class="d-flex gap-2">
                  <div class="form-check mt-1">
                  </div>

                  <!-- ✅ Added: wrap title so JS can find it reliably -->
                  <div class="todo-content">
                    <div class="fw-semibold text-decoration-line-through todo-title">Buy groceries for next week</div>

                    <!-- ✅ Added: hidden edit fields (title + due date) -->
                    <div class="edit-fields d-none">
                      <input type="text" class="form-control form-control-sm mb-2 edit-title" />
                      <input type="date" class="form-control form-control-sm edit-date" />
                    </div>
                  </div>
                </div>

                <div class="d-flex align-items-center gap-2 right-area">
                  <button class="btn btn-sm btn-outline-secondary" title="Check">
                    <i class="fa-solid fa-check"></i>
                  </button>

                  <!-- ✅ Added class for JS -->
                  <button class="btn btn-sm btn-outline-secondary btn-edit" title="Edit">
                    <i class="fa-solid fa-pen"></i>
                  </button>

                  <button class="btn btn-sm btn-outline-danger" title="Delete">
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </div>
              </div>
            </div>

            <!-- Todo item with due date -->
            <div class="todo-item p-3 bg-white">
              <div class="d-flex align-items-start justify-content-between gap-3">
                <div class="d-flex gap-2">
                  <div class="form-check mt-1">
                  </div>

                  <div class="todo-content">
                    <div class="fw-semibold todo-title">Renew car insurance</div>

                    <div class="edit-fields d-none">
                      <input type="text" class="form-control form-control-sm mb-2 edit-title" />
                      <input type="date" class="form-control form-control-sm edit-date" />
                    </div>
                  </div>
                </div>

                <div class="d-flex flex-wrap align-items-center justify-content-end gap-2 right-area">
                  <!-- ✅ Added class for JS -->
                  <span class="pill todo-due">
                    <i class="fa-regular fa-hourglass-half"></i>
                    <span class="due-text">Due: 28 Jun 2020</span>
                  </span>

                  <button class="btn btn-sm btn-outline-secondary" title="Check">
                    <i class="fa-solid fa-check"></i>
                  </button>

                  <button class="btn btn-sm btn-outline-secondary btn-edit" title="Edit">
                    <i class="fa-solid fa-pen"></i>
                  </button>

                  <button class="btn btn-sm btn-outline-danger" title="Delete">
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </div>
              </div>
            </div>

            <!-- Todo item highlighted (active) -->
            <div class="todo-item p-3 bg-white">
              <div class="d-flex align-items-start justify-content-between gap-3">
                <div class="d-flex gap-2">
                  <div class="form-check mt-1">
                  </div>

                  <div class="todo-content">
                    <div class="fw-semibold todo-title">Sign up for online course</div>

                    <div class="edit-fields d-none">
                      <input type="text" class="form-control form-control-sm mb-2 edit-title" />
                      <input type="date" class="form-control form-control-sm edit-date" />
                    </div>
                  </div>
                </div>

                <div class="d-flex align-items-center gap-2 right-area">
                  <button class="btn btn-sm btn-outline-secondary" title="Check">
                    <i class="fa-solid fa-check"></i>
                  </button>

                  <button class="btn btn-sm btn-outline-secondary btn-edit" title="Edit">
                    <i class="fa-solid fa-pen"></i>
                  </button>

                  <button class="btn btn-sm btn-outline-danger" title="Delete">
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Today label
    document.getElementById("todayDate").textContent =
      new Date().toLocaleDateString(undefined, { weekday: "long", year: "numeric", month: "long", day: "numeric" });

    // ---------- Edit functionality ----------
    document.addEventListener("click", function (e) {
      // Start from the element that was clicked, go up the DOM tree, and find the nearest element that has the class btn-edit
      const editBtn = e.target.closest(".btn-edit");
      if (!editBtn) return;

      const todoItem = editBtn.closest(".todo-item");
      if (!todoItem) return;
// Inside todoItem, find the first element that has the class todo-title
      const titleEl = todoItem.querySelector(".todo-title");
      const editFields = todoItem.querySelector(".edit-fields");
      const editTitle = todoItem.querySelector(".edit-title");
      const editDate = todoItem.querySelector(".edit-date");

      // Right-side container (where due pill usually lives)
      const rightArea = todoItem.querySelector(".right-area");

      // Helper: parse existing due date pill (if present) into yyyy-mm-dd
      const duePill = todoItem.querySelector(".todo-due");
      const currentTitle = titleEl.textContent.trim();
      const currentIsoDate = duePill ? (duePill.dataset.isoDate || "") : "";

      const isEditing = todoItem.classList.contains("is-editing");

      if (!isEditing) {
        // ENTER edit mode
        todoItem.classList.add("is-editing");

        // store originals (for cancel)
        todoItem.dataset.originalTitle = currentTitle;
        todoItem.dataset.originalIsoDate = currentIsoDate;

        // prefill fields
        editTitle.value = currentTitle;
        editDate.value = currentIsoDate; // empty if none

        // toggle UI
        titleEl.classList.add("d-none");

        editFields.classList.remove("d-none");

        // swap edit button to "Save" + add Cancel button
        editBtn.title = "Save";
        editBtn.innerHTML = '<i class="fa-solid fa-save"></i>';
        editBtn.classList.add("btn-save");
        editBtn.classList.remove("btn-edit");

        // add a cancel button next to save if not already
          const cancel = document.createElement("button");
          cancel.className = "btn btn-sm btn-outline-secondary btn-cancel";
          cancel.type = "button";
          cancel.title = "Cancel";
          cancel.innerHTML = '<i class="fa-solid fa-xmark"></i>';
          // Inserts the cancel element immediately after editBtn in the DOM.
          editBtn.insertAdjacentElement("afterend", cancel);

        return;
      }
    });

    // Handle Save / Cancel
    document.addEventListener("click", function (e) {
      const saveBtn = e.target.closest(".btn-save");
      const cancelBtn = e.target.closest(".btn-cancel");

      if (!saveBtn && !cancelBtn) return;

      const todoItem = (saveBtn || cancelBtn).closest(".todo-item");
      if (!todoItem) return;

      const titleEl = todoItem.querySelector(".todo-title");
      const editFields = todoItem.querySelector(".edit-fields");
      const editTitle = todoItem.querySelector(".edit-title");
      const editDate = todoItem.querySelector(".edit-date");

      // Right-side container (where we should insert due pill if needed)
      const rightArea = todoItem.querySelector(".right-area");
      const exitEditMode = () => {
        todoItem.classList.remove("is-editing");

        titleEl.classList.remove("d-none");
        editFields.classList.add("d-none");

        // turn Save back into Edit
        const btn = todoItem.querySelector(".btn-save");
        if (btn) {
          btn.title = "Edit";
          btn.innerHTML = '<i class="fa-solid fa-pen"></i>';
          btn.classList.add("btn-edit");
          btn.classList.remove("btn-save");
        }

        // remove cancel
        const cancel = todoItem.querySelector(".btn-cancel");
        if (cancel) cancel.remove();
      };

      if (cancelBtn) {
        // CANCEL: restore old values
        titleEl.textContent = todoItem.dataset.originalTitle;

        const oldIso = todoItem.dataset.originalIsoDate || "";
        updateDuePill(todoItem, rightArea, oldIso);

        exitEditMode();
        return;
      }

      if (saveBtn) {
        // SAVE: apply new values
        const newTitle = editTitle.value.trim() || "Untitled task";
        const newIso = editDate.value; // "" if cleared

        titleEl.textContent = newTitle;
        updateDuePill(todoItem, rightArea, newIso);

        exitEditMode();
      }
    });



    // Creates/updates/removes the due pill based on isoDate (yyyy-mm-dd)
    function updateDuePill(todoItem, rightArea, isoDate) {
      let pill = todoItem.querySelector(".todo-due");

      // Remove pill if date cleared
      if (!isoDate) {
        if (pill) pill.remove();
        return;
      }

      // Create pill if missing
      if (!pill) {
        pill = document.createElement("span");
        pill.className = "pill todo-due";
        pill.innerHTML = '<i class="fa-regular fa-hourglass-half"></i> <span class="due-text"></span>';

        // Put it at the beginning of the right-side actions row (before buttons)
        if (rightArea) rightArea.prepend(pill);
      }

      // Store iso date for later prefill
      pill.dataset.isoDate = isoDate;

      // Format display
      const d = new Date(isoDate + "T00:00:00");
      const formatted = d.toLocaleDateString(undefined, { day: "2-digit", month: "short", year: "numeric" });

      const textEl = pill.querySelector(".due-text");
      if (textEl) textEl.textContent = "Due: " + formatted;
    }
    const addTaskBtn = document.getElementById("addTaskBtn");
const taskInput = document.getElementById("taskInput");
const dateInput = document.getElementById("dateInput");
const taskListContainer = document.querySelector(".col-lg-8 .card-body"); // The container for items

addTaskBtn.addEventListener("click", function() {
  const title = taskInput.value.trim();
  const dueDate = dateInput.value;

  if (!title) {
      taskInput.focus();
    return;
  }

  // Create the task HTML structure
  const newTask = document.createElement("div");
  newTask.className = "todo-item p-3 bg-white";
  newTask.innerHTML = `
    <div class="d-flex align-items-start justify-content-between gap-3">
      <div class="d-flex gap-2">
        <div class="todo-content">
          <div class="fw-semibold todo-title">${title}</div>
          <div class="edit-fields d-none">
            <input type="text" class="form-control form-control-sm mb-2 edit-title" value="${title}" />
            <input type="date" class="form-control form-control-sm edit-date" value="${dueDate}" />
          </div>
        </div>
      </div>
      <div class="d-flex flex-wrap align-items-center justify-content-end gap-2 right-area">
        ${dueDate ? `
          <span class="pill todo-due" data-iso-date="${dueDate}">
            <i class="fa-regular fa-hourglass-half"></i>
            <span class="due-text">Due: ${new Date(dueDate + "T00:00:00").toLocaleDateString(undefined, {day:'2-digit', month:'short', year:'numeric'})}</span>
          </span>` : ''}
        <button class="btn btn-sm btn-outline-secondary btn-check-task" title="Check"><i class="fa-solid fa-check"></i></button>
        <button class="btn btn-sm btn-outline-secondary btn-edit" title="Edit"><i class="fa-solid fa-pen"></i></button>
        <button class="btn btn-sm btn-outline-danger btn-delete" title="Delete"><i class="fa-solid fa-trash"></i></button>
      </div>
    </div>`;

  taskListContainer.appendChild(newTask);
  
  // Clear inputs
  taskInput.value = "";
  dateInput.value = "";
});
document.addEventListener("click", function (e) {
  // DELETE Logic
  const deleteBtn = e.target.closest(".btn-delete") || e.target.closest(".btn-outline-danger");
  if (deleteBtn && !deleteBtn.classList.contains('btn-save')) { // check it's not the save button
    deleteBtn.closest(".todo-item").remove();
  }

  // CHECK/COMPLETE Logic
  const checkBtn = e.target.closest(".btn-check-task") || (e.target.closest(".btn-outline-secondary") && e.target.querySelector('.fa-check'));
  if (checkBtn) {
    const todoItem = checkBtn.closest(".todo-item");
    const titleEl = todoItem.querySelector(".todo-title");
    
    // Toggle completed state
    todoItem.classList.toggle("completed"); 
    titleEl.classList.toggle("text-decoration-line-through");
    titleEl.classList.toggle("text-muted");
    
    // Optional: change button color when checked
    checkBtn.classList.toggle("btn-success");
    checkBtn.classList.toggle("btn-outline-secondary");
  }
});
const filterSelect = document.querySelector(".form-select");

filterSelect.addEventListener("change", function() {
  const filterValue = this.value; // "All", "Active", or "Completed"
  const items = document.querySelectorAll(".todo-item");

  items.forEach(item => {
    const isCompleted = item.classList.contains("completed");

    switch (filterValue) {
      case "All":
        item.classList.remove("d-none");
        break;
      case "Active":
        isCompleted ? item.classList.add("d-none") : item.classList.remove("d-none");
        break;
      case "Completed":
        isCompleted ? item.classList.remove("d-none") : item.classList.add("d-none");
        break;
    }
  });
});
  </script>
</body>
</html>
